---
title: "Vignette"
author: "Shijia Zhang"
date: "2024-08-28"
output: html_document
---

```{r}
library(devtools)
install_github("Shijia1997/ADMerge", upgrade = "never")
library(ADMerge)
# library(dplyr)
library(knitr)
# library(readxl)
library(kableExtra)
```

# updated

```{r}
BIOCARD_table =get_src_table(path = "BIOCARD Demonstration",
              ID_usr_list = c("SUBJECT_ID"),
              DATE_usr_list = c("VISITDATE","DIAGDATE","date"),
              IS_overlap_list = c("FALSE"),
              WINDOW_list = c(366))

plot_files(path = "BIOCARD Demonstration", dict_src = BIOCARD_table, study_type = "BIOCARD",date_type = "Date") 

Biocard_merged = ad_merge(path = "BIOCARD Demonstration",DATE_type = "Date",timeline_file = "BIOCARD_DiagnosisData_2021.11.01",dict_src = BIOCARD_table)

complete_output = review_complete(Biocard_merged,check_cols = c("LogMem1_B","LogMem2_B","DIAGNOSIS","DOB","RACE","AB40","AB42"))

#complete_output$plot

Biocard_merged$analysis_data

complete_output$complete_df
```



# Initial overview table, BIOCARD

```{r}
get_src_table(path = "BIOCARD Demonstration")
```

```{r}
BIOCARD_table =get_src_table(path = "BIOCARD Demonstration",
              ID_usr_list = c("SUBJECT_ID"),
              DATE_usr_list = c("VISITDATE","DIAGDATE","date"),
              IS_overlap_list = c("FALSE"),
              WINDOW_list = c(366))

BIOCARD_table
```

```{r}
plot_files(path = "BIOCARD Demonstration", dict_src = BIOCARD_table, study_type = "BIOCARD",date_type = "Date") 
```


```{r}
Biocard_merged = ad_merge(path = "BIOCARD Demonstration",DATE_type = "Date",timeline_file = "BIOCARD_DiagnosisData_2021.11.01",dict_src = BIOCARD_table)

complete_output = review_complete(Biocard_merged,check_cols = c("LogMem1_B","LogMem2_B","DIAGNOSIS","DOB","RACE","AB40","AB42"))

#complete_output$plot

Biocard_merged$analysis_data
```


```{r}
Biocard_merged = ad_merge(path = "BIOCARD Demonstration",DATE_type = "Date",timeline_file = "BIOCARD_DiagnosisData_2021.11.01",dict_src = BIOCARD_table)


Biocard_merged$analysis_data$DIAGNOSIS
complete_output = review_complete(Biocard_merged,check_cols = c("LogMem1_B","LogMem2_B","DIAGNOSIS","DOB","RACE","AB40","AB42"))

complete_output

```


# Example with ADNI data

```{r}
get_src_table(path = "ADNI Demonstration",)
```
```{r}
library(dplyr)

ADNI_table = get_src_table(path = "ADNI Demonstration",
                           ID_usr_list = c("RID"),
                           DATE_usr_list = c("VISDATE","EXAMDATE","VISDATE","EXAMDATE","EXAMDATE"),
                           non_longitudinal_list = c("APOERES_ADNI_1_2_3"),
                           IS_overlap_list = c("FALSE","FALSE","FALSE","TRUE","FALSE","FALSE"),
                           WINDOW_list = c(366))

plot_files(path = "ADNI Demonstration", dict_src = ADNI_table, study_type = "ADNI",date_type = "Date") 

ADNI_merged = ad_merge(path = "ADNI_Demonstration",
DATE_type = "Date",
timeline_file = "DXSUM",
dict_src = ADNI_table)

ADNI_merged$analysis_data %>% filter(COLPROT == "ADNI3")


```
# ADNI example

```{r}
ADNI_table = get_src_table(path = "ADNI Demonstration",
                           ID_usr_list = c("RID"),
                           DATE_usr_list = c("VISDATE","EXAMDATE","VISDATE","EXAMDATE"),
                           non_longitudinal_list = c("APOERES_ADNI_1_2_3"),
                           IS_overlap_list = c("FALSE","FALSE","FALSE","TRUE","FALSE"),
                           WINDOW_list = c(366))

plot_files(path = "ADNI Demonstration", dict_src = ADNI_table, study_type = "ADNI",date_type = "Date") 

ADNI_merged = ad_merge(path = "ADNI_Demonstration",
DATE_type = "Date",
timeline_file = "DXSUM",
dict_src = ADNI_table)

ADNI_merged$analysis_data %>% filter(COLPROT == "ADNI3")
```


